var I=(i,t)=>()=>(t||i((t={exports:{}}).exports,t),t.exports);var u=I((S,m)=>{m.exports={name:"core",module:"index.ts",version:"0.0.1",type:"module",private:!0,devDependencies:{"@types/bun":"latest"},peerDependencies:{typescript:"^5"}}});class p{plugins=[];constructor(){this.plugins=[]}registerPlugin(i){let t=new i;return console.info(`[Highlite] New plugin ${t.pluginName} registered`),document.highlite[t.pluginName]=t,this.plugins.push(t),!0}startAll(){for(let i of this.plugins)i.start()}stopAll(){for(let i of this.plugins)i.stop()}initAll(){for(let i of this.plugins)i.init()}postInitAll(){for(let i of this.plugins)if(i.postInit)i.postInit()}}class r{pluginLoader=new p;constructor(){console.info("[Highlite] Core Initializing!"),document.highlite={},document.highlite.gameHooks={},document.highlite.gameHooks.Classes={},document.highlite.gameHooks.Listeners={},this.registerClass("mk","EntityManager"),this.registerClass("hN","GroundItemManager"),this.registerClass("oF","MeshManager"),this.registerClass("_F","WorldMapManager"),this.registerClass("GR","AtmosphereManager"),this.registerClass("sD","WorldEntityManager"),this.registerClass("_z","SpellManager"),this.registerClass("Ak","SpellMeshManager"),this.registerClass("Rk","GameLoop"),this.registerClass("zV","ChatManager"),this.registerClass("gz","RangeManager"),this.registerClass("Dz","SocketManager"),this.registerClass("Nz","ItemManager"),this.registerClass("kz","GameEngine"),this.registerClassHook("GameLoop","_update"),this.registerClassHook("SocketManager","_loggedIn"),this.registerClassHook("SocketManager","_handleLoggedOut"),document.dispatchEvent(new Event("DOMContentLoaded",{bubbles:!0,cancelable:!0}))}start(){console.info("[Highlite] Core Started!"),this.pluginLoader.initAll(),this.pluginLoader.postInitAll(),this.pluginLoader.startAll()}stop(){console.info("[Highlite] Core Stopped!"),this.pluginLoader.stopAll()}reload(){console.info("[Highlite] Core Reloading"),this.stop(),this.start()}registerClass(i,t){let e=document.client.get(i);if(!e)return console.warn(`[Highlite] ${i} (${t}) is not defined in client.`),!1;return document.highlite.gameHooks.Classes[t]=e,!0}registerClassHook(i,t,e=this.hook){let h=this,l=document.highlite.gameHooks.Classes[i].prototype;if(!l)console.warn(`[Highlite] Attempted to register unknown client class hook (${i}).`);let n=t;if(n.startsWith("_"))n=n.substring(1);let o=`${i}_${n}`;return function(V){l[t]=function(...v){let y=V.apply(this,arguments);return e.apply(h,[o,...v,this]),y}}(l[t]),!0}hook(i,...t){for(let e of this.pluginLoader.plugins)if(typeof e[i]==="function")try{e[i].apply(e,t)}catch(h){console.error(`[${e.pluginName}] Error with Hook ${i}: ${h}`)}}}class g{gameHooks=document.highlite.gameHooks;log(...i){console.info(`[Highlite][${this.pluginName} Plugin]`,...i)}info(...i){console.info(`[Highlite][${this.pluginName} Plugin]`,...i)}warn(...i){console.warn(`[Highlite][${this.pluginName} Plugin]`,...i)}error(...i){console.error(`[Highlite][${this.pluginName} Plugin]`,...i)}}var $=u();class d extends g{pluginName="HPAlert";settings={volume:0.5,activationPercent:0.5,enabled:!0};init(){this.log("Initializing")}start(){this.log("Started")}stop(){this.log("Stopped")}GameLoop_update(...i){let t=this.gameHooks.Classes.EntityManager.Instance._mainPlayer;if(t===void 0)return;if(t._hitpoints==null)return;if(t._hitpoints._currentLevel/t._hitpoints._level<0.5){let e=new AudioContext,h=e.createGain();h.gain.value=0.1,h.connect(e.destination);let l=e.createOscillator();l.type="triangle",l.frequency.setValueAtTime(440,e.currentTime),l.connect(h),l.start(e.currentTime),l.stop(e.currentTime+0.2);let n=e.createOscillator();n.type="triangle",n.frequency.setValueAtTime(440,e.currentTime+0.25),n.connect(h),n.start(e.currentTime+0.25),n.stop(e.currentTime+0.45)}}}var T=u();class E extends g{pluginName="VersionNotification";highliteVersionElement=null;settings={};init(){this.log("Initializing"),this.highliteVersionElement=document.createElement("button"),this.highliteVersionElement.id="login-screen-clear-game-cache-button",this.highliteVersionElement.className="login-screen-default-text-shadow",this.highliteVersionElement.innerText=`Highlite Version ${T.version}`,this.highliteVersionElement.style="left 0; right: auto; margin:.75rem;",document.getElementById("game-container")?.appendChild(this.highliteVersionElement)}SocketManager_loggedIn(...i){if(!this.highliteVersionElement)return;this.highliteVersionElement.style.visibility="hidden"}SocketManager_handleLoggedOut(...i){if(!this.highliteVersionElement)return;this.highliteVersionElement.style.visibility="visible"}start(){this.log("Started")}stop(){this.log("Stopped")}}s();function s(){let i=new r;i.pluginLoader.registerPlugin(E),i.pluginLoader.registerPlugin(d),i.start()}
